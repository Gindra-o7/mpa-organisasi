---
import { ArrowUpRight } from "@lucide/astro";

const title = "Informasi Jurusan";
const linkHref = "https://stiepancasetia.siakad.net/pmb";

const jurusanListData = {
  data: [
    {
      nama: "Manajemen",
      deskripsi: "Program studi Manajemen mempersiapkan mahasiswa menjadi manajer profesional yang mampu mengelola organisasi bisnis dengan efektif dan efisien di era digital.",
      slug: "manajemen",
    },
    {
      nama: "Akuntansi",
      deskripsi: "Program studi Akuntansi menghasilkan lulusan yang kompeten dalam bidang akuntansi keuangan, audit, perpajakan, dan sistem informasi akuntansi.",
      slug: "akuntansi",
    },
    {
      nama: "Ekonomi Pembangunan",
      deskripsi: "Program studi Ekonomi Pembangunan fokus pada analisis kebijakan ekonomi, pembangunan daerah, dan strategi pengembangan ekonomi berkelanjutan.",
      slug: "ekonomi-pembangunan",
    },
    {
      nama: "Sistem Informasi",
      deskripsi: "Program studi Sistem Informasi mengintegrasikan teknologi informasi dengan manajemen bisnis untuk menciptakan solusi digital yang inovatif.",
      slug: "sistem-informasi",
    },
    {
      nama: "Administrasi Bisnis",
      deskripsi: "Program studi Administrasi Bisnis mencetak profesional yang mahir dalam mengelola operasional bisnis, sumber daya manusia, dan strategi pemasaran.",
      slug: "administrasi-bisnis",
    },
    {
      nama: "Kewirausahaan",
      deskripsi: "Program studi Kewirausahaan membekali mahasiswa dengan keterampilan praktis dalam membangun dan mengembangkan bisnis startup yang berkelanjutan.",
      slug: "kewirausahaan",
    },
  ],
};
---

<section class="bg-white py-10 md:py-20 font-sora">
  <div class="px-6 2xl:px-28 flex flex-col gap-10">
    <div class="flex gap-7 flex-col lg:flex-row lg:items-center lg:justify-between">
      <div class="lg:w-7/12">
        <h2 class="text-3xl md:text-5xl font-bold text-gray-900 tracking-tight leading-tight">
          {title}
        </h2>
      </div>
      <div class="w-56 -mr-1 flex justify-end items-center h-full relative">
        <div class="absolute left-2.5 bg-[#ac1234]/60 w-14 h-14 rounded-full"></div>
        <a
        href={linkHref}
        target="_blank" class="gap-1 cursor-pointer hover:underline flex items-center" >
        <span class="z-10 font-medium">Syarat Pendaftaran</span>
        <ArrowUpRight class="w-7 h-7 text-black" />
      </div>
    </div>
  </div>

  <div class="embla-carousel relative -mx-4">
    <div class="embla__viewport overflow-hidden md:ml-4">
      <div class="embla__container flex md:-ml-4">
        {
          jurusanListData.data.map((jurusan: { nama: string; deskripsi: string; slug: string }) => (
            <a href={`/program-studi/${jurusan.slug}`} class="embla__slide hover:cursor-pointer hover:scale-95 transition-all active:scale-100 duration-250 flex-grow-0 flex-shrink-0 basis-full md:basis-1/2 lg:basis-1/3 min-w-0 md:pl-4">
              <div class="border hover:border-amber-700 hover:bg-amber-50 border-gray-700 p-8 rounded-xl flex flex-col justify-between h-full">
                <div>
                  <h5 class="text-2xl font-bold mb-4 text-gray-900">{jurusan.nama}</h5>
                  <p class="text-gray-700 leading-relaxed text-base">{jurusan.deskripsi}</p>
                </div>
              </div>
            </a>
          ))
        }
      </div>
    </div>

    <button
      class="embla__prev absolute md:top-1/2 md:-translate-y-1/2 top-1.5 left-1 md:left-[-2.5rem] hidden md:flex items-center justify-center md:w-12 md:h-12 w-8 h-8 bg-amber-300/50 backdrop-blur-sm rounded-full shadow-md text-gray-800 hover:bg-white focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-gray-500 disabled:opacity-30 disabled:cursor-not-allowed transition-opacity"
    >
      <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"></path></svg>
    </button>
    <button
      class="embla__next absolute md:top-1/2 md:-translate-y-1/2 bottom-3.5 md:-right-[3.4rem] right-3 flex items-center justify-center md:w-12 md:h-12 w-8 h-8 bg-amber-300/50 backdrop-blur-sm rounded-full shadow-md text-gray-800 hover:bg-white focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-gray-500 disabled:opacity-30 disabled:cursor-not-allowed transition-opacity"
    >
      <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"></path></svg>
    </button>
  </div>
</section>

<script>
  import EmblaCarousel from "embla-carousel";

  const emblaRoot = document.querySelector(".embla-carousel");

  if (emblaRoot) {
    const viewport = emblaRoot.querySelector<HTMLElement>(".embla__viewport");
    const prevBtn = emblaRoot.querySelector<HTMLButtonElement>(".embla__prev");
    const nextBtn = emblaRoot.querySelector<HTMLButtonElement>(".embla__next");

    if (viewport && prevBtn && nextBtn) {
      const emblaApi = EmblaCarousel(viewport, { loop: true, align: "start" });

      const updateArrowButtons = () => {
        if (!emblaApi) return;
        prevBtn.disabled = !emblaApi.canScrollPrev();
        nextBtn.disabled = !emblaApi.canScrollNext();
      };

      // REVISI: Gunakan arrow function untuk menjaga konteks 'this'
      prevBtn.addEventListener("click", () => emblaApi.scrollPrev(), false);
      nextBtn.addEventListener("click", () => emblaApi.scrollNext(), false);

      emblaApi.on("select", updateArrowButtons);
      emblaApi.on("reInit", updateArrowButtons);

      updateArrowButtons();
    }
  }
</script>
